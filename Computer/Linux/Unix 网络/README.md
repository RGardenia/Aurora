# Unix 网络编程







## 五种 IO 模型

​	文件描述符 `(File descriptor)` 是计算机科学中的一个术语，是一个用于表述指向文件的引用的抽象化概念。文件描述符在形式上是一个非负整数。实际上，它是一个索引值，指向内核为每一个进程所维护的该进程打开文件的记录表。当程序打开一个现有文件或者创建一个新文件时，内核向进程返回一个文件描述符。在程序设计中，文件描述符这一概念往往只适用于UNIX、Linux 这样的操作系统。



### Blocking IO   阻塞 IO



### None Blocking IO   非阻塞IO



### IO multiplexing   IO 多路复用

​	一种同步的 IO 模型，实现一个线程监视多个文件句柄，一旦某个文件句柄就绪就能够通知到对应应用程序进行相应的读写操作，没有文件句柄就绪时，就会阻塞应用程序，从而释放CPU资源

​	一个服务端进程可以同时处理多个套接字描述符

> I/O：网络 I/O，尤其在操作系统层面指数据在内核态和用户态之间的读写操作
> 多路：多个客户端连接   连接就是套接字描述符，即 socket 或者 channel
> 复用：复用一个或几个线程。
> IO多路复用：也就是说一个或一组线程处理多个TCP连接，使用单进程就能够实现同时处理多个客户端的连接，无需创建或者维护过多的进程/线程

实现 IO 多路复用的模型有3种：可以分 `select->poll->epoll` 三个阶段来描述

​	将用户 Socket 对应的文件描述符 `(FileDescriptor)` 注册进 `epoll` ，然后 `epoll` 帮你监听哪些 Socket 上有消息到达，这样就避免了大量的无用操作。此时的 Socket 应该采用非阻塞模式。这样，整个过程只在调用 `select`、`poll`、 `epoll` 这些调用的时候才会阻塞，收发客户消息是不会阻塞的，整个进程或者线程就被充分利用起来，这就是事件驱动，所谓的 reactor 反应模式。
​	在单个线程通过记录跟踪每一个 Socket (I/O流) 的状态来同时管理多个 I/O 流,一个服务端进程可以同时处理多个套接字描述符。
目的是尽量多的提高服务器的吞吐能力。
​	大家都用过 nginx，nginx 使用 `epoll` 接收请求，ngnix 会有很多链接进来， `epoll` 会把他们都监视起来，然后像拨开关一样，谁有数据就拨向谁，然后调用相应的代码处理。redis 类似同理，这就是IO多路复用原理，有请求就响应，没请求不打扰。

​	采用多路 IO 复用技术可以让单个线程高效的处理多个连接请求，一个服务端进程可以同时处理多个套接字描述符。

### signal driven IO   信号驱动 IO



### asynchronous IO   异步 IO



