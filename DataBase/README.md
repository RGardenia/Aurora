# æ•°æ®åº“ä¸­é—´ä»¶



## æ•°æ®åº“äº‹åŠ¡

**äº‹åŠ¡ï¼ˆTransactionï¼‰**æ˜¯å¹¶å‘æ§åˆ¶çš„åŸºæœ¬å•ä½ã€‚æ‰€è°“çš„äº‹åŠ¡ï¼Œ**å®ƒæ˜¯ä¸€ä¸ªæ“ä½œåºåˆ—ï¼Œè¿™äº›æ“ä½œè¦ä¹ˆéƒ½æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œ**ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ã€‚
(æ•°æ®åº“å¼•æ“innoDBæ˜¯æ”¯æŒäº‹åŠ¡çš„(é»˜è®¤æ¯ä¸€æ¡`sql`è¯­å¥ä¸ºä¸€ä¸ªäº‹åŠ¡)ï¼ŒMyISAMä¸æ”¯æŒäº‹åŠ¡ã€‚)
åœ¨`å…³ç³»æ•°æ®åº“`ä¸­,ä¸€ä¸ªäº‹åŠ¡å¯ä»¥æ˜¯ä¸€æ¡SQLè¯­å¥ã€ä¸€ç»„SQLè¯­å¥æˆ–æ•´ä¸ªç¨‹åºã€‚ 
ã€€å¼€å§‹äº‹åŠ¡ï¼šBEGIN TRANSACTIONï¼ˆäº‹åŠ¡ï¼‰
ã€€æäº¤äº‹åŠ¡ï¼šCOMMIT TRANSACTIONï¼ˆäº‹åŠ¡ï¼‰
ã€€å›æ»šäº‹åŠ¡ï¼šROLLBACK TRANSACTIONï¼ˆäº‹åŠ¡ï¼‰



## äº‹åŠ¡çš„å››å¤§å±æ€§   ACID

1. **åŸå­æ€§ï¼ˆA**tomicityï¼‰: äº‹åŠ¡å¼€å§‹åçš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨åšå®Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸åšï¼Œä¸å¯ä»¥åœæ»åœ¨ä¸­é—´ç¯èŠ‚ã€‚äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­è‹¥å‡ºé”™ï¼Œä¼šå›æ»šåˆ°äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ï¼Œæ‰€æœ‰çš„æ“ä½œå°±åƒæ²¡æœ‰å‘ç”Ÿä¸€æ ·ã€‚äº‹åŠ¡æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„æ•´ä½“ã€‚

2. **ä¸€è‡´æ€§**ï¼ˆ**C**onsistencyï¼‰: äº‹åŠ¡å¼€å§‹å‰å’Œç»“æŸåï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§çº¦æŸæ²¡æœ‰è¢«ç ´åã€‚

3. **éš”ç¦»æ€§ï¼ˆI**solationï¼‰: åŒä¸€æ—¶é—´ï¼Œåªå…è®¸ä¸€ä¸ªäº‹åŠ¡è¯·æ±‚åŒä¸€æ•°æ®ï¼Œä¸åŒçš„äº‹åŠ¡ä¹‹é—´å½¼æ­¤æ²¡æœ‰ä»»ä½•å¹²æ‰°ã€‚

   ï¼ˆä¸€ä¸ªäº‹åŠ¡å†…éƒ¨çš„æ“ä½œåŠæ­£åœ¨æ“ä½œçš„æ•°æ®å¿…é¡»å°è£…èµ·æ¥ï¼Œä¸è¢«å…¶å®ƒä¼å›¾è¿›è¡Œä¿®æ”¹çš„äº‹åŠ¡çœ‹åˆ°ï¼‰

4. **æŒä¹…æ€§ï¼ˆD**urabilityï¼‰: äº‹åŠ¡å®Œæˆåï¼Œäº‹åŠ¡å¯¹æ•°æ®åº“çš„æ‰€æœ‰æ›´æ–°å°†è¢«ä¿å­˜åˆ°æ•°æ®åº“ï¼Œä¸èƒ½å›æ»šã€‚

   >  åŸå­æ€§æ˜¯äº‹åŠ¡éš”ç¦»çš„åŸºç¡€ï¼Œéš”ç¦»æ€§å’ŒæŒä¹…æ€§æ˜¯æ‰‹æ®µï¼Œæœ€ç»ˆç›®çš„æ˜¯ä¸ºäº†ä¿æŒæ•°æ®çš„ä¸€è‡´æ€§ã€‚



## éš”ç¦»çº§åˆ«

è„è¯»ï¼šæŒ‡è¯»å–åˆ°å…¶ä»–äº‹åŠ¡æ­£åœ¨å¤„ç†çš„æœªæäº¤æ•°æ®ã€‚

ä¸å¯é‡å¤è¯»ï¼šæŒ‡å¹¶å‘æ›´æ–°æ—¶ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡å‰åæŸ¥è¯¢ç›¸åŒæ•°æ®**å†…å®¹**æ—¶çš„æ•°æ®ä¸ç¬¦åˆé¢„æœŸã€‚

å¹»è¯»ï¼šæŒ‡å¹¶å‘æ–°å¢ã€åˆ é™¤è¿™ç§ä¼šäº§ç”Ÿ**æ•°é‡**å˜åŒ–çš„æ“ä½œæ—¶ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡å‰åæŸ¥è¯¢ç›¸åŒæ•°æ®æ—¶ä¸ç¬¦åˆé¢„æœŸã€‚

**MySQL é»˜è®¤éš”ç¦»çº§åˆ« RRï¼ŒMySQL 5.1 ä»¥åé»˜è®¤å­˜å‚¨å¼•æ“å°±æ˜¯ InnoDBï¼Œå› æ­¤ MySQL é»˜è®¤ RR ä¹Ÿèƒ½è§£å†³å¹»è¯»é—®é¢˜**ã€‚

| éš”ç¦»çº§åˆ«             | ä¸­æ–‡åç§° | è§£å†³çš„é—®é¢˜             | å­˜åœ¨çš„é—®é¢˜                    | MySQL é»˜è®¤ | ç®€è¦è¯´æ˜                                     |
| -------------------- | -------- | ---------------------- | ----------------------------- | ---------- | -------------------------------------------- |
| **READ UNCOMMITTED** | è¯»æœªæäº¤ | æ—                      | è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»        | å¦         | å…è®¸è¯»å–æœªæäº¤çš„æ•°æ®ï¼Œæœ€ä½éš”ç¦»çº§åˆ«ï¼Œå‡ ä¹ä¸ç”¨ |
| **READ COMMITTED**   | è¯»å·²æäº¤ | è„è¯»                   | ä¸å¯é‡å¤è¯»ã€å¹»è¯»              | å¦         | åªèƒ½è¯»åˆ°å·²æäº¤çš„æ•°æ®ï¼ŒOracle é»˜è®¤            |
| **REPEATABLE READ**  | å¯é‡å¤è¯» | è„è¯»ã€ä¸å¯é‡å¤è¯»       | å¹»è¯»ï¼ˆInnoDB å·²ç”¨é—´éš™é”è§£å†³ï¼‰ | **æ˜¯**     | æ¯æ¬¡æŸ¥è¯¢ç»“æœä¸€è‡´ï¼ŒMySQL é»˜è®¤                 |
| **SERIALIZABLE**     | ä¸²è¡ŒåŒ–   | è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯» | æ€§èƒ½æœ€å·®ï¼Œäº‹åŠ¡ä¸²è¡Œï¼Œä¸¥é‡é˜»å¡  | å¦         | å¼ºåˆ¶äº‹åŠ¡ä¸²è¡Œï¼Œå‡ ä¹ä¸ç”¨                       |

| éš”ç¦»çº§åˆ«         | è„è¯»å¯èƒ½æ€§ | ä¸å¯é‡å¤è¯»å¯èƒ½æ€§ | å¹»è¯»å¯èƒ½æ€§       | åŠ é”è¯» |
| ---------------- | ---------- | ---------------- | ---------------- | ------ |
| READ UNCOMMITTED | æ˜¯         | æ˜¯               | æ˜¯               | å¦     |
| READ COMMITTED   | å¦         | æ˜¯               | æ˜¯               | å¦     |
| REPEATABLE READ  | å¦         | å¦               | æ˜¯ï¼ˆInnoDBé™¤å¤–ï¼‰ | å¦     |
| SERIALIZATION    | å¦         | å¦               | å¦               | æ˜¯     |

åœ¨ MySQL InnoDB å­˜å‚¨å¼•æ“ä¸‹RCã€RRåŸºäº MVCC ï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰è¿›è¡Œå¹¶å‘äº‹åŠ¡æ§åˆ¶ã€‚MVCC æ˜¯åŸºäº â€œæ•°æ®ç‰ˆæœ¬â€ å¯¹å¹¶å‘äº‹åŠ¡çš„è®¿é—®ã€‚

### å››å¤§éš”ç¦»çº§åˆ«

- READ UNCOMMITTEDï¼ˆ**è¯»æœªæäº¤æ•°æ®**ï¼‰ï¼šå…è®¸äº‹åŠ¡è¯»å–æœªè¢«å…¶ä»–äº‹åŠ¡æäº¤çš„å˜æ›´æ•°æ®ï¼Œä¼šå‡ºç°è„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»é—®é¢˜ã€‚

- READ COMMITTEDï¼ˆ**è¯»å·²æäº¤æ•°æ®**ï¼‰ï¼šåªå…è®¸äº‹åŠ¡è¯»å–å·²ç»è¢«å…¶ä»–äº‹åŠ¡æäº¤çš„å˜æ›´æ•°æ®ï¼Œå¯é¿å…è„è¯»ï¼Œä»ä¼šå‡ºç°ä¸å¯é‡å¤è¯»å’Œå¹»è¯»é—®é¢˜ã€‚

- REPEATABLE READï¼ˆ**å¯é‡å¤è¯»**ï¼‰ï¼šç¡®ä¿äº‹åŠ¡å¯ä»¥å¤šæ¬¡ä»ä¸€ä¸ªå­—æ®µä¸­è¯»å–ç›¸åŒçš„å€¼ï¼Œåœ¨æ­¤äº‹åŠ¡æŒç»­æœŸé—´ï¼Œç¦æ­¢å…¶ä»–äº‹åŠ¡å¯¹æ­¤å­—æ®µçš„æ›´æ–°ï¼Œå¯ä»¥é¿å…è„è¯»å’Œä¸å¯é‡å¤è¯»ï¼Œä»ä¼šå‡ºç°å¹»è¯»é—®é¢˜ã€‚

- SERIALIZABLEï¼ˆ**åºåˆ—åŒ–/ä¸²è¡ŒåŒ–**ï¼‰ï¼šå®ƒè¦æ±‚äº‹åŠ¡åºåˆ—åŒ–æ‰§è¡Œï¼Œäº‹åŠ¡åªèƒ½ä¸€ä¸ªæ¥ç€ä¸€ä¸ªåœ°æ‰§è¡Œï¼Œä½†ä¸èƒ½å¹¶å‘æ‰§è¡Œã€‚ç¡®ä¿äº‹åŠ¡å¯ä»¥ä»ä¸€ä¸ªè¡¨ä¸­è¯»å–ç›¸åŒçš„è¡Œï¼Œåœ¨è¿™ä¸ªäº‹åŠ¡æŒç»­æœŸé—´ï¼Œç¦æ­¢å…¶ä»–äº‹åŠ¡å¯¹è¯¥è¡¨æ‰§è¡Œæ’å…¥ã€æ›´æ–°å’Œåˆ é™¤æ“ä½œï¼Œå¯é¿å…æ‰€æœ‰å¹¶å‘é—®é¢˜ï¼Œä½†æ€§èƒ½éå¸¸ä½ã€‚



éš”ç¦»çº§åˆ«è¶Šé«˜ï¼Œè¶Šèƒ½ä¿è¯æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§ï¼Œä½†æ˜¯å¯¹å¹¶å‘æ€§èƒ½çš„å½±å“ä¹Ÿè¶Šå¤§ã€‚

å¯¹äºå¤šæ•°åº”ç”¨ç¨‹åºï¼Œå¯ä»¥ä¼˜å…ˆè€ƒè™‘æŠŠæ•°æ®åº“ç³»ç»Ÿçš„éš”ç¦»çº§åˆ«è®¾ä¸º`Read Committed`ï¼Œå®ƒèƒ½å¤Ÿé¿å…è„è¯»å–ï¼Œè€Œä¸”å…·æœ‰è¾ƒå¥½çš„å¹¶å‘æ€§èƒ½ã€‚å°½ç®¡å®ƒä¼šå¯¼è‡´ä¸å¯é‡å¤è¯»ã€è™šè¯»å’Œç¬¬äºŒç±»ä¸¢å¤±æ›´æ–°è¿™äº›å¹¶å‘é—®é¢˜ï¼Œåœ¨å¯èƒ½å‡ºç°è¿™ç±»é—®é¢˜çš„ä¸ªåˆ«åœºåˆï¼Œå¯ä»¥ç”±åº”ç”¨ç¨‹åºé‡‡ç”¨æ‚²è§‚é”æˆ–ä¹è§‚é”æ¥æ§åˆ¶ã€‚
MySQLæ”¯æŒå››ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œå…¶ä¸­`REPEATABLE READ`ä¸ºé»˜è®¤äº‹åŠ¡éš”ç¦»çº§åˆ«ã€‚



## äº‹åŠ¡çš„å¹¶å‘é—®é¢˜ 

>  (ä¸¢å¤±æ›´æ–°ã€è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»)

1ã€**ä¸¢å¤±æ›´æ–°**ï¼šå¦‚æœä¸¤ä¸ªäº‹åŠ¡Aå’ŒBéƒ½è¦æ›´æ–°æ•°æ®åº“ä¸€ä¸ªå­—æ®µï¼Œå¹¶åŒæ—¶è·å¾—ç›¸åŒæ•°æ®ï¼Œç„¶ååœ¨å„è‡ªäº‹åŠ¡ä¸­åŒæ—¶ä¿®æ”¹äº†è¯¥æ•°æ®ï¼Œé‚£ä¹ˆå…ˆæäº¤çš„äº‹åŠ¡Aæ›´æ–°ä¼šè¢«åæäº¤äº‹åŠ¡Bçš„æ›´æ–°ç»™è¦†ç›–æ‰ï¼Œè¿™ç§æƒ…å†µäº‹åŠ¡Açš„æ›´æ–°å°±è¢«è¦†ç›–æ‰äº†ã€ä¸¢å¤±äº†ã€‚
2ã€**è„è¯»**ï¼šäº‹åŠ¡Aè¯»å–äº†äº‹åŠ¡Bæ›´æ–°(ä½†æœªæäº¤)çš„æ•°æ®ï¼Œç„¶åBå›æ»šæ“ä½œï¼Œé‚£ä¹ˆAè¯»å–åˆ°çš„æ•°æ®æ˜¯è„æ•°æ®ï¼›
3ã€**ä¸å¯é‡å¤è¯»**ï¼šäº‹åŠ¡ A ä¸­å¤šæ¬¡è¯»å–åŒä¸€æ•°æ®ï¼Œäº‹åŠ¡ B åœ¨äº‹åŠ¡Aå¤šæ¬¡è¯»å–çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹æ•°æ®ä½œäº†æ›´æ–°å¹¶æäº¤ï¼Œå¯¼è‡´äº‹åŠ¡Aå¤šæ¬¡è¯»å–åŒä¸€æ•°æ®æ—¶ï¼Œç»“æœä¸ä¸€è‡´ã€‚
4ã€**å¹»è¯»**ï¼šç¬¬ä¸€ä¸ªäº‹åŠ¡å¯¹ä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®è¿›è¡Œäº†ä¿®æ”¹ï¼Œæ¯”å¦‚è¿™ç§ä¿®æ”¹æ¶‰åŠåˆ°è¡¨ä¸­çš„â€œå…¨éƒ¨æ•°æ®è¡Œâ€ã€‚åŒæ—¶ï¼Œç¬¬äºŒä¸ªäº‹åŠ¡ä¹Ÿä¿®æ”¹è¿™ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œè¿™ç§ä¿®æ”¹æ˜¯å‘è¡¨ä¸­æ’å…¥â€œä¸€è¡Œæ–°æ•°æ®â€ã€‚é‚£ä¹ˆï¼Œä»¥åå°±ä¼šå‘ç”Ÿæ“ä½œç¬¬ä¸€ä¸ªäº‹åŠ¡çš„ç”¨æˆ·å‘ç°è¡¨ä¸­è¿˜å­˜åœ¨æ²¡æœ‰ä¿®æ”¹çš„æ•°æ®è¡Œï¼Œå°±å¥½è±¡å‘ç”Ÿäº†å¹»è§‰ä¸€æ ·ã€‚

>  å°ç»“ï¼šä¸å¯é‡å¤è¯»çš„å’Œå¹»è¯»å¾ˆå®¹æ˜“æ··æ·†ï¼Œä¸å¯é‡å¤è¯»ä¾§é‡äºä¿®æ”¹ï¼Œå¹»è¯»ä¾§é‡äºæ–°å¢æˆ–åˆ é™¤ã€‚è§£å†³ä¸å¯é‡å¤è¯»çš„é—®é¢˜åªéœ€é”ä½æ»¡è¶³æ¡ä»¶çš„è¡Œï¼Œè§£å†³å¹»è¯»éœ€è¦é”è¡¨ã€‚





## ğŸ” **å¸¸è§ç´¢å¼•å¤±æ•ˆåŸå› **

| åœºæ™¯                             | è§£é‡Š                                                         |
| -------------------------------- | ------------------------------------------------------------ |
| **1. LIKE '%xxx' æ¨¡ç³ŠæŸ¥è¯¢**      | ä»¥ `%` å¼€å¤´ï¼Œæ— æ³•èµ° B+ æ ‘ç´¢å¼•ï¼Œå› ä¸ºå‰ç¼€æ— æ³•å®šä½èŠ‚ç‚¹          |
| **2. WHERE ä½¿ç”¨å‡½æ•°åŒ…è£¹å­—æ®µ**    | å¦‚ `WHERE DATE(create_time) = '2024-01-01'` â†’ ç´¢å¼•å¤±æ•ˆ       |
| **3. éšå¼ç±»å‹è½¬æ¢**              | æ¯”å¦‚ `WHERE id = '123'`ï¼Œå­—æ®µæ˜¯ intï¼Œä¼ å­—ç¬¦ä¸²ï¼Œç´¢å¼•å¤±æ•ˆ      |
| **4. OR æŸ¥è¯¢æœªå…¨éƒ¨ç”¨ç´¢å¼•å­—æ®µ**   | `WHERE a = 1 OR b = 2`ï¼Œå¦‚æœ b æ²¡æœ‰ç´¢å¼• â†’ å…¨è¡¨æ‰«             |
| **5. è´Ÿå‘æ“ä½œ**                  | `!=`ã€`NOT IN`ã€`NOT EXISTS` ç­‰ï¼Œå¾ˆéš¾ç”¨ç´¢å¼•ä¼˜åŒ–              |
| **6. è¦†ç›–ç´¢å¼•è¢« SELECT \* ç ´å** | è¦†ç›–ç´¢å¼•å¿…é¡»æŸ¥è¯¢çš„å­—æ®µéƒ½åœ¨ç´¢å¼•é‡Œï¼Œä¸€æ—¦ç”¨ `SELECT *` å¯èƒ½å¯¼è‡´å›è¡¨ |
| **7. è”åˆç´¢å¼•å­—æ®µé¡ºåºä¸åˆç†**    | å»º `idx(a, b)`ï¼ŒæŸ¥è¯¢åªç”¨ `b=xxx`ï¼Œa æ²¡æœ‰ç”¨ï¼Œç´¢å¼•å¤±æ•ˆ         |







## é”

ä»æ•°æ®åº“ç³»ç»Ÿçš„è§’åº¦æ¥çœ‹ï¼Œé”åˆ†ä¸ºå…±äº«é”å’Œæ’ä»–é”ï¼Œä»ç¨‹åºå‘˜çš„è§’åº¦çœ‹ï¼Œé”åˆ†ä¸ºæ‚²è§‚é”å’Œä¹è§‚é”ã€‚

**å…±äº«é”(Sé”,  è¯»é”)**
å…±äº«é”é”å®šçš„èµ„æºå¯ä»¥è¢«å…¶å®ƒç”¨æˆ·è¯»å–ï¼Œä½†å…¶å®ƒç”¨æˆ·ä¸èƒ½ä¿®æ”¹å®ƒã€‚åœ¨ SELECT å‘½ä»¤æ‰§è¡Œæ—¶ï¼ŒSQL Server é€šå¸¸ä¼šå¯¹å¯¹è±¡è¿›è¡Œå…±äº«é”é”å®šã€‚é€šå¸¸åŠ å…±äº«é”çš„æ•°æ®é¡µè¢«è¯»å–å®Œæ¯•åï¼Œå…±äº«é”å°±ä¼šç«‹å³è¢«é‡Šæ”¾ã€‚

**æ’ä»–/ç‹¬å é”(Xé”ï¼Œå†™é”)**
ç‹¬å é”é”å®šçš„èµ„æºåªå…è®¸è¿›è¡Œé”å®šæ“ä½œçš„ç¨‹åºä½¿ç”¨ï¼Œå…¶å®ƒä»»ä½•å¯¹å®ƒçš„æ“ä½œå‡ä¸ä¼šè¢«æ¥å—ã€‚æ‰§è¡Œæ•°æ®æ›´æ–°å‘½ä»¤ï¼Œå³ INSERTã€UPDATE æˆ– DELETE å‘½ä»¤æ—¶ï¼ŒSQL Server ä¼šè‡ªåŠ¨ä½¿ç”¨ç‹¬å é”ã€‚ä½†å½“å¯¹è±¡ä¸Šæœ‰å…¶å®ƒé”å­˜åœ¨æ—¶ï¼Œæ— æ³•å¯¹å…¶åŠ ç‹¬å é”ã€‚ç‹¬å é”ä¸€ç›´åˆ°äº‹åŠ¡ç»“æŸæ‰èƒ½è¢«é‡Šæ”¾ã€‚

> å…±äº«é”å¯ä»¥ä¸€å±‚å¥—ä¸€å±‚å¾—ä¸Šé”ï¼Œä½†æ’ä»–é”åªèƒ½åŠ ä¸€ä¸ªã€‚ 

**ä¹è§‚é”**
æ€»æ˜¯è®¤ä¸ºä¸ä¼šäº§ç”Ÿå¹¶å‘é—®é¢˜ï¼Œæ¯æ¬¡å»å–æ•°æ®çš„æ—¶å€™æ€»è®¤ä¸ºä¸ä¼šæœ‰å…¶ä»–çº¿ç¨‹å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œå› æ­¤ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯**åœ¨æ›´æ–°æ—¶ä¼šåˆ¤æ–­å…¶ä»–çº¿ç¨‹åœ¨è¿™ä¹‹å‰æœ‰æ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹**ï¼Œä¸€èˆ¬ä¼š**ä½¿ç”¨ç‰ˆæœ¬å·æœºåˆ¶æˆ–CASæ“ä½œ**å®ç°ã€‚

**versionæ–¹å¼**ï¼šä¸€èˆ¬æ˜¯åœ¨æ•°æ®è¡¨ä¸­åŠ ä¸Šä¸€ä¸ªæ•°æ®ç‰ˆæœ¬å·`version`å­—æ®µï¼Œè¡¨ç¤ºæ•°æ®è¢«ä¿®æ”¹çš„æ¬¡æ•°ï¼Œå½“æ•°æ®è¢«ä¿®æ”¹æ—¶ï¼Œversionå€¼ä¼šåŠ ä¸€ã€‚å½“çº¿ç¨‹Aè¦æ›´æ–°æ•°æ®å€¼æ—¶ï¼Œåœ¨è¯»å–æ•°æ®çš„åŒæ—¶ä¹Ÿä¼šè¯»å–versionå€¼ï¼Œåœ¨æäº¤æ›´æ–°æ—¶ï¼Œè‹¥åˆšæ‰è¯»å–åˆ°çš„versionå€¼ä¸ºå½“å‰æ•°æ®åº“ä¸­çš„versionå€¼ç›¸ç­‰æ—¶æ‰æ›´æ–°ï¼Œå¦åˆ™é‡è¯•æ›´æ–°æ“ä½œï¼Œç›´åˆ°æ›´æ–°æˆåŠŸã€‚

**æ‚²è§‚é”**
æ€»æ˜¯å‡è®¾æœ€åçš„æƒ…å†µï¼Œæ¯æ¬¡å–æ•°æ®æ—¶éƒ½è®¤ä¸ºå…¶ä»–çº¿ç¨‹ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥éƒ½ä¼š**åŠ é”ï¼ˆè¯»é”ã€å†™é”ã€è¡Œé”ç­‰ï¼‰**ï¼Œå½“å…¶ä»–çº¿ç¨‹æƒ³è¦è®¿é—®æ•°æ®æ—¶ï¼Œéƒ½éœ€è¦é˜»å¡æŒ‚èµ·ã€‚å¯ä»¥ä¾é æ•°æ®åº“å®ç°ï¼Œå¦‚è¡Œé”ã€è¯»é”å’Œå†™é”ç­‰ï¼Œéƒ½æ˜¯åœ¨æ“ä½œä¹‹å‰åŠ é”ï¼Œåœ¨Javaä¸­ï¼Œ**synchronized** çš„æ€æƒ³ä¹Ÿæ˜¯æ‚²è§‚é”ã€‚

> æ ¹æ®èŒƒå›´ï¼Œé”è¿˜å¯ä»¥åˆ’åˆ†æˆè¡Œçº§é”å’Œè¡¨é”

**æ„å‘é”**

- æ„å‘å…±äº«é”ï¼ˆISï¼‰ï¼ŒåŠ è¡Œå…±äº«é”ä¹‹å‰éœ€è¦å¾—åˆ°çš„é”
- æ„å‘æ’ä»–é”ï¼ˆIXï¼‰ï¼ŒåŠ è¡Œæ’ä»–é”ä¹‹å‰éœ€è¦å¾—åˆ°é”





# Redis

Spring Boot

```yaml
# ---------------- Redis é›†ç¾¤-----------------
spring.redis.password=111111
# è·å–å¤±è´¥ æœ€å¤§é‡å®šå‘æ¬¡æ•°
spring.redis.cluster.max-redirects=3
spring.redis.lettuce.pool.max-active=8
spring.redis.lettuce.pool.max-wait=-1ms
spring.redis.lettuce.pool.max-idle=8
spring.redis.lettuce.pool.min-idle=0
# æ”¯æŒé›†ç¾¤æ‹“æ‰‘åŠ¨æ€æ„Ÿåº”åˆ·æ–°ï¼Œè‡ªé€‚åº”æ‹“æ‰‘åˆ·æ–°æ˜¯å¦ä½¿ç”¨æ‰€æœ‰å¯ç”¨çš„æ›´æ–°ï¼Œé»˜è®¤falseå…³é—­
spring.redis.lettuce.cluster.refresh.adaptive=true
# å®šæ—¶åˆ·å‰‚
spring.redis.lettuce.cluster.refresh.period=2000
spring.redis.cluster.nodes=192.168.111.185:6381,192.168.111.185:6382,192.168.111.172:6383,192.168.111.172:6384
```

